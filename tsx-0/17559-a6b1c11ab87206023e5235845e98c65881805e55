{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{exec}from\"child_process\";import{IS_VERCEL_ENV,IS_DOCKER_ENV,FILE_BASED_MCP_CONFIG}from\"lib/const\";import{promisify}from\"util\";import\"load-env\";const execPromise=promisify(exec);async function runCommand(command,description){console.log(`Starting: ${description}`);try{const{stdout,stderr}=await execPromise(command,{cwd:process.cwd(),env:process.env});console.log(`${description} output:`);console.log(stdout);if(stderr){console.error(`${description} stderr:`);console.error(stderr)}console.log(`${description} finished successfully.`)}catch(error){console.error(`${description} error:`,error);process.exit(1)}}__name(runCommand,\"runCommand\");async function main(){if(IS_VERCEL_ENV){if(FILE_BASED_MCP_CONFIG){console.error(\"File based MCP config is not supported on Vercel.\");process.exit(1)}console.log(\"Running on Vercel, performing database migration.\");await runCommand(\"pnpm db:migrate\",\"Database migration\")}else if(IS_DOCKER_ENV){if(FILE_BASED_MCP_CONFIG){console.error(\"File based MCP config is not supported in Docker.\");process.exit(1)}}else{console.log(\"Running in a normal environment, performing initial environment setup.\");await runCommand(\"pnpm initial:env\",\"Initial environment setup\");await runCommand(\"pnpm openai-compatiable:init\",\"Initial openAI compatiable config setup\")}}__name(main,\"main\");main();\n","warnings":[],"map":{"version":3,"mappings":"kHAAA,OAAS,SAAY,gBACrB,OAAS,cAAe,cAAe,0BAA6B,YACpE,OAAS,cAAiB,OAC1B,MAAO,WACP,MAAM,YAAc,UAAU,IAAI,EAElC,eAAe,WAAW,QAAiB,YAAqB,CAC9D,QAAQ,IAAI,aAAa,WAAW,EAAE,EACtC,GAAI,CACF,KAAM,CAAE,OAAQ,MAAO,EAAI,MAAM,YAAY,QAAS,CACpD,IAAK,QAAQ,IAAI,EACjB,IAAK,QAAQ,GACf,CAAC,EAED,QAAQ,IAAI,GAAG,WAAW,UAAU,EACpC,QAAQ,IAAI,MAAM,EAElB,GAAI,OAAQ,CACV,QAAQ,MAAM,GAAG,WAAW,UAAU,EACtC,QAAQ,MAAM,MAAM,CACtB,CACA,QAAQ,IAAI,GAAG,WAAW,yBAAyB,CACrD,OAAS,MAAY,CACnB,QAAQ,MAAM,GAAG,WAAW,UAAW,KAAK,EAC5C,QAAQ,KAAK,CAAC,CAChB,CACF,CApBe,gCAsBf,eAAe,MAAO,CACpB,GAAI,cAAe,CACjB,GAAI,sBAAuB,CACzB,QAAQ,MAAM,mDAAmD,EACjE,QAAQ,KAAK,CAAC,CAChB,CACA,QAAQ,IAAI,mDAAmD,EAC/D,MAAM,WAAW,kBAAmB,oBAAoB,CAC1D,SAAW,cAAe,CACxB,GAAI,sBAAuB,CACzB,QAAQ,MAAM,mDAAmD,EACjE,QAAQ,KAAK,CAAC,CAChB,CACF,KAAO,CACL,QAAQ,IACN,wEACF,EACA,MAAM,WAAW,mBAAoB,2BAA2B,EAChE,MAAM,WACJ,+BACA,yCACF,CACF,CACF,CAvBe,oBAyBf,KAAK","names":[],"ignoreList":[],"sources":["/root/chat-ai/scripts/postinstall.ts"],"sourcesContent":[null]}}